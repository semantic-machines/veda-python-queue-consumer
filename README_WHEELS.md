# Использование предкомпилированных wheel-файлов

Этот документ описывает, как использовать предкомпилированные wheel-файлы для библиотеки v-queue-python.

## Структура директории с wheel-файлами

```
wheels/
├── ubuntu24.04-x86_64/
│   ├── v_queue_python-0.1.0-cp310-cp310-linux_x86_64.whl
│   ├── v_queue_python-0.1.0-cp310-cp310-linux_x86_64.json
│   └── platform-info.txt
├── ubuntu22.04-x86_64/
│   ├── v_queue_python-0.1.0-cp310-cp310-linux_x86_64.whl
│   ├── v_queue_python-0.1.0-cp310-cp310-linux_x86_64.json
│   └── platform-info.txt
└── debian12-x86_64/
    ├── v_queue_python-0.1.0-cp311-cp311-linux_x86_64.whl
    ├── v_queue_python-0.1.0-cp311-cp311-linux_x86_64.json
    └── platform-info.txt
```

## Файлы метаданных

Для каждого wheel-файла создаются два файла метаданных:

1. **JSON-файл** (например, `v_queue_python-0.1.0-cp310-cp310-linux_x86_64.json`):
   - Содержит детальную машиночитаемую информацию о среде сборки
   - Включает данные о системе, версии Python, Rust и других компонентах

2. **Текстовый файл** (`platform-info.txt`):
   - Содержит человекочитаемую информацию о среде сборки
   - Удобен для быстрой проверки совместимости

## Как создать wheel-файл с метаданными

Используйте скрипт `build_wheel.py` для автоматического создания wheel-файла с метаданными:

```bash
# Установите необходимые зависимости
pip install setuptools wheel setuptools-rust

# Запустите скрипт сборки
python build-wheel.py
```

Скрипт автоматически:
1. Соберет wheel-файл
2. Определит информацию о текущей системе
3. Создаст директорию в `wheels/` с учетом дистрибутива и архитектуры
4. Скопирует wheel-файл в эту директорию
5. Создаст файлы метаданных

## Как использовать предкомпилированный wheel-файл

### Вариант 1: Прямая установка через pip

```bash
# Создайте виртуальное окружение
python3 -m venv venv
source venv/bin/activate

# Установите wheel-файл для вашей платформы
pip install wheels/ubuntu24.04-x86_64/v_queue_python-0.1.2-cp310-cp310-linux_x86_64.whl
```

### Вариант 2: Использование в requirements.txt

```
# Для Ubuntu 24.04 x86_64
./wheels/ubuntu24.04-x86_64/v_queue_python-0.1.0-cp310-cp310-linux_x86_64.whl

# ИЛИ для установки из исходного кода, если wheel не подходит
# git+https://github.com/ваша-организация/v-queue-python.git
```

## Выбор подходящего wheel-файла

1. Проверьте ваш дистрибутив и версию Python:
   ```bash
   # Узнать дистрибутив
   lsb_release -a
   
   # Узнать версию Python
   python --version
   
   # Узнать архитектуру
   uname -m
   ```

2. Выберите соответствующий wheel:
   - Проверьте совпадение дистрибутива
   - Проверьте версию Python (например, cp310 для Python 3.10)
   - Проверьте архитектуру (например, x86_64)

3. Если подходящего wheel-файла нет, установите из исходного кода:
   ```bash
   pip install git+https://github.com/ваша-организация/v-queue-python.git
   ```

## Как добавить новые wheel-файлы

1. Клонируйте репозиторий на нужную платформу
2. Запустите скрипт `build_wheel.py`
3. Добавьте созданные файлы в git
   ```bash
   git add wheels/
   git commit -m "Add wheel for Ubuntu 24.04 x86_64 with Python 3.10"
   git push
   ```

## Устранение проблем

При возникновении ошибок импорта после установки wheel-файла:

1. Проверьте совместимость версий дистрибутива и Python:
   ```bash
   cat wheels/вашаплатформа/platform-info.txt
   ```

2. Проверьте наличие необходимых системных библиотек, указанных в метаданных
   
3. При необходимости установите недостающие зависимости:
   ```bash
   # Пример для Ubuntu
   sudo apt-get install libстандартная-библиотека-версия
   ```

4. В случае несовместимости, используйте установку из исходного кода
